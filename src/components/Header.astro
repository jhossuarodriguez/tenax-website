---
import { Image } from "astro:assets";
---

<header
    class="fixed top-0 left-0 right-0 px-4 sm:px-8 lg:px-20 py-3 w-full h-auto z-50"
>
    <div class="flex flex-row justify-between items-center">
        <div class="flex justify-start items-center">
            <a
                class="flex items-center hover:scale-105 transition-transform duration-200"
                href="/"
                title="Ir a la página principal de Tenax Construction"
                aria-label="Ir a la página principal"
            >
                <Image
                    class="w-32 sm:w-40 md:w-48 lg:w-60 h-auto"
                    width="240"
                    height="180"
                    src="/logo-tenax.webp"
                    alt="Logo Tenax Construction"
                    format="webp"
                    fetchpriority="high"
                    decoding="async"
                    loading="eager"
                />
            </a>
        </div>

        <!-- Botón hamburguesa para móvil -->
        <button
            id="mobile-menu-button"
            class="md:hidden flex flex-col justify-center items-center w-8 h-8 bg-transparent border-none cursor-pointer z-60"
            aria-label="Abrir menú de navegación"
            aria-expanded="false"
        >
            <span
                class="block w-6 h-0.5 bg-white mb-1 transition-all duration-300 ease-in-out"
            ></span>
            <span
                class="block w-6 h-0.5 bg-white mb-1 transition-all duration-300 ease-in-out"
            ></span>
            <span
                class="block w-6 h-0.5 bg-white transition-all duration-300 ease-in-out"
            ></span>
        </button>

        <nav
            id="mobile-menu"
            class="hidden md:flex md:relative md:top-auto md:left-auto md:w-auto md:h-auto md:bg-transparent md:backdrop-blur-none md:flex-row md:justify-center md:items-center md:gap-4 lg:gap-8 md:pt-0 fixed top-0 left-0 w-full h-screen bg-black/95 backdrop-blur-lg flex-col justify-center items-center gap-8 uppercase text-lg md:text-[15px] font-normal pt-20"
        >
            <a
                href="#inicio"
                class="relative inline-block hover:text-[#F46738] pb-1 group tracking-tight text-white transition-colors duration-200"
                title="Ir a la página de inicio"
                aria-label="Ir a la página de inicio"
            >
                Inicio
                <span
                    class="absolute left-0 bottom-0 w-full h-0.5 bg-[#F46738] scale-x-0 group-hover:scale-x-100 transition-transform origin-left"
                ></span>
            </a>
            <a
                class="relative inline-block hover:text-[#F46738] pb-1 group tracking-tight text-white transition-colors duration-200"
                href="#nosotros"
                title="Ir a la página de nosotros"
                aria-label="Ir a la página de nosotros"
                >Nosotros
                <span
                    class="absolute left-0 bottom-0 w-full h-0.5 bg-[#F46738] scale-x-0 group-hover:scale-x-100 transition-transform origin-left"
                ></span>
            </a>
            <a
                class="relative inline-block text-white hover:text-[#F46738] pb-1 group tracking-tight font-medium transition-colors duration-200"
                href="#proyectos"
                title="Ir a la página de proyectos"
                aria-label="Ir a la página de proyectos"
                >Proyectos
                <span
                    class="absolute left-0 bottom-0 w-full h-0.5 bg-[#F46738] scale-x-0 group-hover:scale-x-100 transition-transform origin-left"
                ></span>
            </a>
            <a
                class="relative inline-block hover:text-[#F46738] pb-1 group tracking-tight text-white transition-colors duration-200"
                href="#servicios"
                title="Ir a la página de servicios"
                aria-label="Ir a la página de servicios"
                >Servicios
                <span
                    class="absolute left-0 bottom-0 w-full h-0.5 bg-[#F46738] scale-x-0 group-hover:scale-x-100 transition-transform origin-left"
                ></span>
            </a>

            <a
                class="relative inline-block text-white hover:text-[#F46738] pb-1 group tracking-tight transition-colors duration-200"
                href="#noticias"
                title="Ir a la página de noticias"
                aria-label="Ir a la página de noticias"
                >Noticias
                <span
                    class="absolute left-0 bottom-0 w-full h-0.5 bg-[#F46738] scale-x-0 group-hover:scale-x-100 transition-transform origin-left"
                ></span>
            </a>
            <a
                class="relative inline-block text-white hover:text-[#F46738] pb-1 group tracking-tight transition-colors duration-200"
                href="#contacto"
                title="Ir a la página de contacto"
                aria-label="Ir a la página de contacto"
                >Contacto
                <span
                    class="absolute left-0 bottom-0 w-full h-0.5 bg-[#F46738] scale-x-0 group-hover:scale-x-100 transition-transform origin-left"
                ></span>
            </a>
        </nav>

        <!-- Botón de cerrar para móvil -->
        <button
            id="close-menu-button"
            class="md:hidden absolute top-4 right-4 w-8 h-8 bg-transparent border-none cursor-pointer text-white text-2xl z-70 hidden transition-all duration-200 ease-in-out"
            aria-label="Cerrar menú de navegación"
        >
            ×
        </button>
    </div>
</header>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const mobileMenuButton = document.getElementById("mobile-menu-button");
        const closeMenuButton = document.getElementById("close-menu-button");
        const mobileMenu = document.getElementById("mobile-menu");
        const hamburgerSpans = mobileMenuButton?.querySelectorAll("span");

        function toggleMenu() {
            const isOpen = mobileMenu?.classList.contains("flex");

            if (isOpen) {
                mobileMenu?.classList.remove("flex");
                mobileMenu?.classList.add("hidden");
                mobileMenuButton?.setAttribute("aria-expanded", "false");
                document.body.style.overflow = "";

                // Mostrar botón hamburguesa, ocultar botón cerrar
                if (mobileMenuButton) mobileMenuButton.style.display = "flex";
                if (closeMenuButton) closeMenuButton.style.display = "none";

                // Restaurar hamburguesa
                if (hamburgerSpans) {
                    hamburgerSpans[0].style.transform =
                        "rotate(0deg) translate(0, 0)";
                    hamburgerSpans[1].style.opacity = "1";
                    hamburgerSpans[2].style.transform =
                        "rotate(0deg) translate(0, 0)";
                }
            } else {
                mobileMenu?.classList.remove("hidden");
                mobileMenu?.classList.add("flex");
                mobileMenuButton?.setAttribute("aria-expanded", "true");
                document.body.style.overflow = "hidden";

                // Ocultar botón hamburguesa, mostrar botón cerrar
                if (mobileMenuButton) mobileMenuButton.style.display = "none";
                if (closeMenuButton) closeMenuButton.style.display = "block";
            }
        }

        mobileMenuButton?.addEventListener("click", toggleMenu);
        closeMenuButton?.addEventListener("click", toggleMenu);

        // Cerrar menú al hacer clic en un enlace
        const navLinks = mobileMenu?.querySelectorAll("a");
        navLinks?.forEach((link) => {
            link.addEventListener("click", () => {
                if (window.innerWidth < 768) {
                    toggleMenu();
                }
            });
        });

        // Cerrar menú al redimensionar a desktop
        window.addEventListener("resize", () => {
            if (
                window.innerWidth >= 768 &&
                mobileMenu?.classList.contains("flex")
            ) {
                toggleMenu();
            }
        });

        // Asegurar estado inicial correcto
        if (window.innerWidth < 768) {
            if (closeMenuButton) closeMenuButton.style.display = "none";
            if (mobileMenuButton) mobileMenuButton.style.display = "flex";
        }
    });
</script>

<style>
    header {
        background: #00000099;
        animation: header-blur-scroll 0.3s linear both;
        animation-timeline: scroll();
        animation-range: 0 200px;
        border-bottom: 1.3px solid transparent;
    }

    @keyframes header-blur-scroll {
        0% {
            backdrop-filter: blur(0px);
            background: transparent;
        }

        100% {
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.6);
            border-bottom-color: white;
            box-shadow: 0px 0px 5px 0px;
        }
    }
</style>
